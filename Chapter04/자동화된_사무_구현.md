## 📝 Chapter 4: 에이전트 1: 자동화된 사무 구현 - Assistants API와 DALL E 3모델을 이용한 프레젠테이션 제작 

### 1. OpenAI 도우미(Assistant)란?

OpenAI의 도우미(Assistant)는 GPT 모델을 기반으로 언어 이해와 생성을 수행하며, 단순한 정보 제공을 넘어 특정 작업을 수행할 수 있는 AI 플랫폼입니다.

* **에이전트(Agent)와 유사**: 유연하고 다양한 기능을 갖춰 일상 대화부터 복잡한 기술 문제 해결까지 가능합니다.
* **주요 특징**:
* **자연어 이해**: 사용자 의도와 요구 파악.
* **풍부한 텍스트 생성**: 지시에 따른 일관성 있는 응답 생성.
* **적응성과 맞춤 설정**: 특정 시나리오에 맞춘 개인화 서비스 제공.
* **상호작용성**: 대화 문맥을 이해하고 기억하여 연속적인 상호작용 지원.
* **쉬운 통합**: 웹사이트 및 애플리케이션에 손쉽게 통합 가능.



---

### 2. Assistants API의 핵심 구성 요소

Assistants API는 개발자가 대화 이력을 직접 관리할 필요 없이, OpenAI 서비스가 이를 대신 처리해 주는 구조를 가집니다.

#### **A. 도우미 (Assistant)**

* 백엔드에서 지능형 처리 시스템 역할을 수행합니다.
* **생성 파라미터**:
* `name`: 도우미 이름.
* `instructions`: 행동 지침 (예: "당신은 금융 전문가입니다").
* `tools`: 코드 해석기(Code Interpreter), 검색(Retrieval), 함수 호출(Function Calling) 등의 도구 지원.
* `model`: GPT-3.5, GPT-4 등 사용 모델 지정.



#### **B. 대화 흐름 (Thread)**

* 사용자와 도우미 간의 연속적인 대화 세션을 의미합니다.
* **문맥 관리**: 대화 기록을 자동으로 추적하고 관리하여 도우미가 문맥을 이해할 수 있게 돕습니다.
* **독립성**: 기술적으로 도우미와 대화 흐름은 서로 독립적입니다. 하나의 도우미가 여러 스레드에서 활동할 수 있고, 하나의 스레드에 여러 도우미를 호출할 수도 있습니다.

---

### 3. 도우미 구축 및 실행 절차 (4단계)

프로그램 내에서 도우미를 동작시키는 과정은 다음과 같습니다.

1. **도우미 생성**: 지침을 정의하고 모델과 도구를 선택합니다.
2. **대화 흐름(Thread) 생성**: 사용자가 대화를 시작하면 스레드를 생성합니다.
3. **메시지(Message) 추가**: 사용자의 질문이나 데이터를 스레드에 추가합니다.
4. **실행(Run)**: 도우미를 실행하여 응답을 촉발(Trigger)시킵니다. 이 과정에서 관련 도구가 자동으로 호출됩니다.

---

### 4. 실행 세션(Run)의 생명주기 및 상태 관리

도우미가 답변을 생성하는 과정인 '실행 세션(Run)'은 비동기적으로 처리되며, 완료될 때까지 반복적인 상태 확인(Polling)이 필요합니다.

#### **A. 주요 상태(State) 설명**

| 상태 | 설명 |
| --- | --- |
| **대기 중 (queued)** | 실행 세션이 생성되었으나 아직 처리가 시작되지 않음. |
| **진행 중 (in_progress)** | 모델이 추론 중이거나 도구를 사용하며 작업을 수행 중임. |
| **조치 필요 (requires_action)** | 함수 호출 등 사용자의 추가 입력이나 행동이 필요한 상태. |
| **완료 (completed)** | 작업이 성공적으로 끝남. 이때 도우미의 응답 메시지를 확인할 수 있음. |
| **만료 (expired)** | 제한 시간 내에 작업이 완료되지 않거나 조치가 취해지지 않음. |
| **취소 중/취소됨 (cancelling/cancelled)** | 사용자가 실행을 중단시켰을 때의 상태. |
| **실패 (failed)** | 작업 수행 중 오류가 발생함. |

#### **B. 상태 전이 흐름**

* `queued` → `in_progress` → `completed` (성공 시)
* `in_progress` → `requires_action` → `in_progress` (함수 호출 시)

---

### 5. 메시지 및 응답 처리

실행이 `completed` 상태가 되면 대화 흐름(Thread)에서 결과를 조회할 수 있습니다.

* **메시지 구조**: 각 메시지는 `id`, `assistant_id`, `content`(내용), `role`(user/assistant), `created_at` 정보를 포함합니다.
* **활용**: 응답을 단순히 텍스트로 받는 것 외에도, JSON 형식으로 출력을 유도하여 데이터베이스 저장 등 후속 처리를 자동화할 수 있습니다.